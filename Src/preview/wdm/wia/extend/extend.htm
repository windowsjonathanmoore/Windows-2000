<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=us-ascii">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./extend_files/filelist.xml">
<title>Extend</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Dave Parsons</o:Author>
  <o:LastAuthor>Dave Parsons</o:LastAuthor>
  <o:Revision>3</o:Revision>
  <o:TotalTime>354</o:TotalTime>
  <o:Created>1999-11-18T21:52:00Z</o:Created>
  <o:LastSaved>2000-06-29T19:14:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>342</o:Words>
  <o:Characters>1952</o:Characters>
  <o:Company>Microsoft Corp.</o:Company>
  <o:Lines>16</o:Lines>
  <o:Paragraphs>3</o:Paragraphs>
  <o:CharactersWithSpaces>2397</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HideSpellingErrors/>
  <w:HideGrammaticalErrors/>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
h1
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:"Times New Roman";
	color:black;
	mso-font-kerning:18.0pt;
	font-weight:bold;}
h2
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:2;
	font-size:18.0pt;
	font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
h3
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	mso-outline-level:3;
	font-size:13.5pt;
	font-family:"Times New Roman";
	color:black;
	font-weight:bold;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	color:black;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:371000526;
	mso-list-type:hybrid;
	mso-list-template-ids:619977120 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=EN-US link=blue vlink=blue style='tab-interval:.5in'
leftmargin=8>

<div class=Section1>

<h1><a name=MYSAMPLE>Sample </a>User Interface Extension</h1>

<h2>SUMMARY</h2>

<p>This sample shows how to write Windows Image Acquisition (WIA) user
interface (UI) extensions. It adds tabs to the device properties dialog (accessible
from Explorer) and it adds commands to the left pane of the Explorer web view
of a camera. These extensions are applied to the WIA sample camera from this
DDK by providing implementations of IShellPropSheetExt, IContextMenu, and
interfaces for extending the web view.</p>

<p>At the time of this writing, WIA is only supported on Windows Me. This
sample will not work on Windows 98 or Windows 2000.</p>

<h3>BUILDING THE SAMPLE</h3>

<p>To build the sample follow these steps:</p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>In the Start menu, select<span style="mso-spacerun:
yes">&nbsp; </span>&quot;Free Build Environment&quot; or &quot;Checked Build
Environment&quot; under &quot;Windows DDK&quot; to open a command window and
set basic environment variables needed to build drivers. </p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Change to the directory containing the sample driver source
code, src\preview\wdm\wia\extend.</p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Execute the &quot;build&quot; command. After the build
completes, a library named Extend.dll will be located in a subdirectory.</p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .5in'><![if !supportLists]>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Also build the sample camera driver located in the
src\preview\wdm\wia\testcam directory.</p>

<h3>USING THE SAMPLE<o:p></o:p></h3>

<p><! ---------------- Snip  Snip ---------------- >To use the driver, follow
the instructions in the sample camera readme file, <a
href="..\testcam\Testcam.htm">Testcam.htm</a>.</p>

<p>To test the sample UI extensions, open the Scanners and Cameras folder in
Explorer.</p>

<h3>RESOURCES</h3>

<p>WIA information: <a href="http://www.microsoft.com/hwdev/wia">http://www.microsoft.com/hwdev/wia</a></p>

<p>DDK information: <a href="http://www.microsoft.com/ddk/">http://www.microsoft.com/ddk/</a></p>

<h3>CODE TOUR</h3>

<h3>File Manifest</h3>

<pre>Files<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Description</pre><pre>------------ -------------------------------------------------------</pre><pre>classes.h<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Defines interface for extensions</pre><pre>extend.cpp<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>Implements UI extensions</pre><pre>extend.def<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>Linker command file</pre><pre>extend.h<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>Header file for UI extensions</pre><pre>extend.rc<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Resources for UI extensions</pre><pre>makefile<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span>Used for building the UI extensions&#8212;do not modify</pre><pre>precomp.h<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Precompiled header file containing all included headers</pre><pre>resource.h<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>Header file for resources</pre><pre>shellext.cpp Implements IcontextMenu and IShellPropSheetExt</pre><pre>sources<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Controls building of UI extensions</pre><pre>stdafx.cpp<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>Includes standard header files</pre><pre>tcamlogo.jpg Image file to use as a logo</pre><pre>testcam.ico<span style="mso-spacerun: yes">&nbsp; </span>Icon for the extension</pre><pre>wiacamui.rgs Registry entries for UI extensions</pre><pre>extend.htm<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>This readme file</pre></div>

</body>

</html>

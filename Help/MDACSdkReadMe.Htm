<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Microsoft Data Access Components SDK Version 2.5 Readme</TITLE>
<style>
BODY {
	font: x-small Verdana, Arial, Helvetica, sans-serif;
	background-color: #FFFFFF; }
	
h1, h2, h3, h4 {
	font-family: verdana, Arial, Helvetica, sans-serif;	
	font-weight: bold;
	color: #000000; }
	
h1 {
	font-size: 145%;
	margin-bottom: .5em; }
	
h2 {
	font-size: 125%;
	margin-top: 1.5em;
	margin-bottom: .5em; }
	
h3 {
	font-size: 115%;
	margin-top: 1.2em;
	margin-bottom: .5em}
	
h4 {
	font-size: 100%;
	margin-top: 1.2em;
	margin-bottom: .5em; }

P  {
	font: x-small Verdana, Arial, Helvetica, sans-serif;
	color: #000000; }

CODE {
	font: 120% "Courier New", Courier, mono; }

TD {
	font-size: x-small; }

A:LINK {
	color: #0000FF; }
	
A:VISITED {
	color: #660066; }
	
A:HOVER {
	color: #FF9900; }
	
.label {
	font-weight: bold; }
	
.tl {
	margin-bottom: .75em; }
	
.atl {
	padding-left: 1.5em;
	padding-bottom: .75em; }
	
.cfe {
	font-weight: bold; }
	
.mini {
	font-size: smaller; }
	
LI {
	margin-top: .75em;
	margin-bottom: .75em; }
	
UL {
	list-style: disc; }

UL UL, OL OL, OL UL, UL OL {
	margin-top: 1em;
	margin-bottom: 1em; }
	
LI P {
	margin-top: .5em;
	margin-bottom: .5em; }

.dt {
	margin-bottom: -1em; }
	
.indent {
	margin-left: 1.5em; }
	
SUP {
	text-decoration: none;
	font-size: smaller; }

.product
	{
	text-align: right;
	color: #333333;
	font-size: smaller;
	font-style: italic;
	}
</style></HEAD>
<BODY>

<H1><A NAME="mdacsdkreadme"></A>Microsoft Data Access Components (MDAC) SDK Version 2.5 Readme</H1>

<P>© 1999 Microsoft Corporation. All rights reserved.</P>

<P>This document provides late-breaking or other information that supplements the MDAC SDK documentation, including setup and installation information. </P>

<P class=indent><B><B>Note</B></B>&nbsp;&nbsp;&nbsp;The MDAC SDK was formerly called the Microsoft Data Access SDK. Its name has changed as of version 2.5. </P>

<H1><A NAME="mdac_toc"></A>Contents</H1>

<UL type=disc>
	<LI><A HREF="#mdacsdk">MDAC SDK</A><BR><BR></LI>

	<LI><A HREF="#ado">ActiveX Data Objects (ADO)</A><BR><BR></LI>

	<LI><A HREF="#oledb">OLE DB</A><BR><BR></LI>

	<LI><A HREF="#oledbprogrammersreference">OLE DB Programmer's Reference</A><BR><BR></LI>

	<LI><A HREF="#oledbsimpleprovidertoolkit">OLE DB Simple Provider (OSP) Toolkit</A><BR><BR></LI>

	<LI><A HREF="#oledbtesting">OLE DB Testing</A><BR><BR></LI>

	<LI><A HREF="#odbc">Open Database Connectivity (ODBC)</A><BR><BR></LI>

	<LI><A HREF="#componentchecker">Component Checker</A><BR><BR></LI>

	<LI><A HREF="#mdactechnicalarticles">MDAC Technical Articles</A></LI>
</UL>
<hr>
<H1><A NAME="mdacsdk"></A>MDAC SDK</H1>

<P>The following contains late-breaking information about the Microsoft Data Access Components (MDAC) SDK setup and content.</P>

<P class=label><B>MDAC System Requirements</B></P>

<P>The requirements for installing the MDAC SDK are the same as for the Platform SDK. </P>

<P>You must have MDAC version 2.5 installed in order to run the latest samples. </P>

<P><B>Linking Errors Using MDAC 2.5 with Visual C++ 5.0 SP2 and Earlier</B></P>

<P><B>Problem:</B> When using the Visual C++ environment to create a .dll and link an application with the .lib file created, a link error, "Fatal error LNK1106", will be generated.</P>

<P><B>Solution:</B> Visual C++® 5.0 Service Pack 3 or later is required. For more information, see the MDAC SDK Overview documentation under "Using MDAC 2.5 with Microsoft Visual C++." </P>

<P><A HREF="#mdac_toc">Return to Contents</A></P>
<hr>
<H1><A NAME="ado"></A>ActiveX Data Objects (ADO)</H1>

<P>For information about ADO, see the MDAC release notes (MDACReadme.htm). This file is installed with the typical MDAC 2.5 redistribution at <A HREF="http://www.microsoft.com/data/download.htm">http://www.microsoft.com/data/download.htm</A> or with Microsoft Windows® 2000 and is located at &lt;system drive&gt;:\program files\common files\system\ADO\MDACReadme.htm. </P>

<P><A HREF="#mdac_toc">Return to Contents</A></P>
<hr>
<H1><A NAME="oledb"></A>OLE DB</H1>

<P>For information about OLE DB, see the MDAC release notes (MDACReadme.htm). This file is installed with the typical MDAC 2.5 redistribution at <A HREF="http://www.microsoft.com/data/download.htm">http://www.microsoft.com/data/download.htm</A> or with Microsoft Windows® 2000 and is located at &lt;system drive&gt;:\program files\common files\system\ADO\MDACReadme.htm. </P>

<P><A HREF="#mdac_toc">Return to Contents</A></P>
<hr>
<H1><A NAME="oledbprogrammersreference"></A>OLE DB Programmer's Reference</H1>

<P>The following provides late-breaking or other information that supplements the Microsoft OLE DB specification.

<UL type=disc>
	<LI><B>IRowset::RestartPosition Return Values</B>
<P class=tl>The following information about return values for <B>IRowset::GetNextRows</B> was incorrectly placed in the Method comments for <B>IRowset::RestartPosition</B>. The same information appears in both topics; it should appear only in <B>IRowset::GetNextRows</B>. </P>
<P class=tl>Whether a provider returns DB_S_ENDOFROWSET, DB_S_ROWLIMITEXCEEDED, or DB_S_STOPLIMITREACHED is provider-specific but usually depends on which limit is encountered first, as follows:</P>
<UL type=disc>
	<LI>If the maximum number of row handles is obtained before trying to read past the rowset or beyond a resource limit, DB_S_ROWLIMITEXCEEDED is returned. <BR><BR></LI>

	<LI>If a resource limitation is reached when there are still row handles available and before attempting to read past the rowset, DB_S_STOPLIMITREACHED is returned. <BR><BR></LI>

	<LI>If the provider comes to the end of the rowset before using all of the available row handles and before reaching a resource limitation, DB_S_ENDOFROWSET is returned.</LI>
</UL>
</LI>
</UL>

<H2>Data Conversion Issues</H2>

<UL type=disc>
	<LI><B>Scale Ignored for DBTYPE_DECIMAL</B>
<P class=tl>The OLE DB documentation states that conversions to decimal values within the consumer's buffers should follow the scale specified in the accessor's binding structure. Be aware that the data conversion library provided in the SDK ignores the scale value when doing conversions to DBTYPE_DECIMAL.</P></LI>

	<LI><B>International Data and OLE DB Data Conversions</B>
<P class=tl>With OLE DB, most data conversions are independent of locale by spec. In the <I>OLE DB Programmer's Reference,</I> Appendix A, under "Conversions Involving Strings," formats are defined for conversion to and from strings. For example, "...cccc.cccc" is for DBTYPE_CY and "yyyy-mm-dd" for DBTYPE_DBDATE. These formats are independent of locale, which is consistent with the ISO definition of string values representing dates. It is up to the application to convert from the predefined string format to the local string format, if that local format is preferred.</P></LI>
</UL>

<P><A HREF="#mdac_toc">Return to Contents</A></P>
<hr>
<H1><A NAME="oledbsimpleprovidertoolkit"></A>OLE DB Simple Provider (OSP) Toolkit</H1>

<P>The following provides late-breaking or other information that supplements the Microsoft OSP Toolkit documentation.</P>

<P><B>OSP Interface in Microsoft Internet Explorer 4.0</B>

<UL type=disc>
	<LI><B>Simpdata.h</B>
<P class=tl>The OSP interface, described in Simpdata.h, was previously released with Microsoft Internet Explorer 4.0. The OSP interface released with the OLE DB Simple Provider Toolkit includes a modification of the OSPFIND enumeration. It adds enumeration value OSPFIND_UPCASESENSITIVE. Providers written with this value will not compile using the previous version of Simpdata.h.</P></LI>

	<LI><B>OSP Methods for Visual J++ and Internet Explorer 4.0</B>
<P class=tl>The OSP class package for Java developers, com.ms.osp.*, was released in Internet Explorer 4.0 with alternative versions of three of the OSP methods:</P>
<UL type=disc>
	<LI><B>find()</B><BR><BR></LI>

	<LI><B>getVariant()</B><BR><BR></LI>

	<LI><B>setVariant()</B></LI>
</UL>

<P class=tl>In package com.ms.osp.*, these three methods are defined with arguments of type object, instead of the variant forms of the methods defined in the OSP interface, as distributed in this SDK in the type library Simpdata.tlb. Internet Explorer 4.0 contained native marshaling code, invoked by the com.ms.osp.* package, which converts the object instances to Variants (using Variant VT_UNKNOWN as a default). The OSP-to-OLE DB mapping layer released in this SDK, Msdaosp.dll, does not include custom marshaling. As a result, simple providers written in Java using the Internet Explorer com.ms.osp.* package will not work with the OSP DLL released in this SDK unless Internet Explorer 4.0 is installed to provide the custom marshaling.</P></LI>

	<LI><B>Compiling OSP Visual C++ Sample with Visual C++ 6.0</B></LI>
</UL>

<P>The following error may be encountered when compiling the OSP Visual C++ sample with Visual C++ 6.0: "error C2065: 'OSPFIND_UPCASESENSITIVE' : undeclared identifier".</P>

<P>This is due to an older header file, Simpdata.h, in the compiler. As the updated header is available and installed by the MDAC SDK, one of the following actions will address the error:

<UL type=disc>
	<LI>Delete Simpdata.h from the VC directory. By default, this is C:\Tools\VC98\INCLUDE.<BR><BR></LI>

	<LI>Update the copy of Simpdata.h in the VC directory.<BR><BR></LI>

	<LI>In Visual C++, on the <B>Tools</B> menu, click <B>Options</B>. On the <B>Directories</B> tab, move the entry for C:\Tools\VC98\INCLUDE below the entry for C:\MSDASDK\include\osp.<BR><BR></LI>

	<LI>Add the following line to your code to point to the newer header file (modify path to reflect actual location):
<PRE><CODE>#include "c:\msdasdk\include\osp\simpdata.h" 
</CODE></PRE>
</LI>
</UL>

<P><A HREF="#mdac_toc">Return to Contents</A></P>
<hr>
<H1><A NAME="oledbtesting"></A>OLE DB Testing</H1>

<P>The following provides late-breaking or other information that supplements the OLE DB Testing section of the MDAC SDK documentation.</P>

<P class=label><B>TableDump Utility Keywords/Arguments</B></P>

<P>The formation rule for strings containing equal signs and semicolons is best exemplified using the CONNNECTIONSTRING keyword as shown below, not the example in the documentation.</P>

<P>The following tables list and describe the required and optional keywords for the TableDump Utility.</P>

<TABLE border=1 cellpadding=5 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=50%><B>Required Keyword/Value</B></TD>
<TD class=label width=50%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>PROVIDER=ProviderName; </TD>
<TD width=50%>Required—The Provider ProgID of the provider to use. TableDump will use ProgIDToCLSID to convert this to a CLSID to obtain an instance of the provider in <B>CoCreateInstance</B>.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>TABLENAME=TableName; </TD>
<TD width=50%>Required—The <I>TableName</I> to pass to <B>IOpenRowset</B>.
<P class=indent><B><B>Note&nbsp;&nbsp;&nbsp;</B></B>Although the argument is called <I>TableName</I>, this does not imply that TableDump works only with relational providers. Here, <I>TableName</I> just indicates the DBID passed to <B>IOpenRowset</B>.</P>
</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>CONNECTIONSTRING=ConnectionString;</TD>
<TD width=50%>Required—Initialization properties required for connection. The syntax is described in "Connection String Syntax" in Chapter 20 of the OLE DB Core Components. Its value is enclosed in quotes.
<P>For example, CONNECTIONSTRING='Provider=SQLOLEDB; Data Source=MySQLServer; User ID=sa; Password=;'</P>
</TD>
</TR>
</TABLE><BR>

<P class=label></P>

<P class=label></P>

<TABLE border=1 cellpadding=5 frame=below rules=rows>

<TR VALIGN="top">
<TD class=label width=50%><B>Optional Keyword/Value</B></TD>
<TD class=label width=50%><B>Description</B></TD>
</TR>

<TR VALIGN="top">
<TD width=50%>CREATEINDEX=&lt;column ordinal for the index&gt;;</TD>
<TD width=50%>Optional—The column ordinal for the index in the table you have created. For providers that support table creation and ANSI SQL.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>CREATETABLE=&lt;number of rows in table&gt;;</TD>
<TD width=50%>Optional—The number of rows in the table you are creating. For providers that support table creation and ANSI SQL. After creation, you can populate the table on every test run with data of your choosing.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>DEFAULTQUERY=DefaultQuery;&nbsp; </TD>
<TD width=50%>Optional—Usually not needed. If you want to test command support, this is the default command for all queries used by the tests and PrivLib. All entries in the QUERY section will have this command as the default. You can then modify that section based on your provider's required grammar or command syntax.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>OUTPUT=OutputFileName;&nbsp; </TD>
<TD width=50%>Optional—The output file name for the generated .ini file. You can include the entire path, including file name and extension. TableDump will default to the file TableDump.out if this option is not specified.</TD>
</TR>

<TR VALIGN="top">
<TD width=50%>ROOT_URL=RootURL;</TD>
<TD width=50%>Optional—Used for filling in the URL section. All types of URLs in this section are filled in with the URL provided with this keyword. You can then modify individual URLs after the .ini file has been created. If this keyword is absent, the .ini file will not have a URL section.</TD>
</TR>
</TABLE><BR>

<P class=label></P>

<P class=label><B>Corrections to Trace Provider Documentation</B></P>

<P>The Trace Provider tool allows you to trace the calls to a provider and then log the results. The format of the log has been incorrectly labeled in the documentation as text (formatted and unformatted), whereas the released version of the tool writes to the log using XML. An XML output sample follows:</P>

<PRE><CODE>  &lt;?xml version="1.0" ?&gt; 
  &lt;Trace_Log&gt;
  &lt;Create_Instance Type="Pre" ObjectAddress="0x01821430" 
   ProcessID="0x00000668" ThreadID="0x00000698" ProviderName="Microsoft 
   OLE DB Provider for SQL Server" ProviderCLSID="{0C7FF16C-38E3-11D0-
   97AB-00C04FC2AD98}"&gt;
  &lt;InputParameters Total="2"&gt;
  &lt;pUnkOuter Type="IUnknown *" Value="0x01043f78" /&gt; 
  &lt;riid Type="REFIID" Value="0x0133eed0" /&gt; 
  &lt;/InputParameters&gt;
  &lt;/Create_Instance&gt;
  &lt;Create_Instance Type="Post" ObjectAddress="0x01821430" 
   ProcessID="0x00000668" ThreadID="0x00000698" ProviderName="Microsoft 
   OLE DB Provider for SQL Server" ProviderCLSID="{0C7FF16C-38E3-11D0-
   97AB-00C04FC2AD98}"&gt;
  &lt;HRESULT&gt;&lt;/HRESULT&gt; 
  &lt;Duration msec="15.79" /&gt; 
  &lt;OutputParameters Total="1"&gt;
  &lt;ppv Type="void **" Value="0x0012f8a0" /&gt; 
  &lt;/OutputParameters&gt;
  &lt;/Create_Instance&gt;
  &lt;IDBProperties__GetPropertyInfo Type="Pre" ObjectAddress="0x01821498" 
   ProcessID="0x00000668" ThreadID="0x00000698" ProviderName="Microsoft 
   OLE DB Provider for SQL Server" ProviderCLSID="{0C7FF16C-38E3-11D0-
   97AB-00C04FC2AD98}"&gt;
  &lt;InputParameters Total="5"&gt;
  &lt;cPropertyIDSets Type="ULONG" Value="1" /&gt; 
  &lt;rgPropertyIDSets Type="const DBPROPIDSET" Value="1243200" /&gt; 
  &lt;pcPropertyInfoSets Type="ULONG *" Value="0x0012f88c" /&gt; 
  &lt;prgPropertyInfoSets Type="DBPROPINFOSET **" Value="0x0012f870" /&gt; 
  &lt;ppDescBuffer Type="OLECHAR **" Value="0x0012f878" /&gt; 
  &lt;/InputParameters&gt;
...</CODE></PRE>

<P><A HREF="#mdac_toc">Return to Contents</A></P>
<hr>
<H1><A NAME="odbc"></A>Open Database Connectivity (ODBC)</H1>

<P>For information about ODBC, see the MDAC release notes (MDACReadme.htm). This file is installed with the typical MDAC 2.5 redistribution at <A HREF="http://www.microsoft.com/data/download.htm">http://www.microsoft.com/data/download.htm</A> or with Microsoft Windows® 2000 and is located at &lt;system drive&gt;:\program files\common files\system\ADO\MDACReadme.htm. </P>

<P><A HREF="#mdac_toc">Return to Contents</A></P>
<hr>
<H1><A NAME="componentchecker"></A>Component Checker</H1>

<P>Version 2.5 of the MDAC SDK includes the Component Checker tool, which is designed to determine and diagnose installation issues with MDAC. Component Checker is frequently updated to accommodate new versions of MDAC. For the latest version of Component Checker, please see <A HREF="http://www.microsoft.com/data/download.htm">http://www.microsoft.com/data/download.htm</A>. </P>

<P>See the MDAC SDK Overview topic "What's New in the MDAC SDK" for more information.</P>

<P><A HREF="#mdac_toc">Return to Contents</A></P>
<hr>
<H1><A NAME="mdactechnicalarticles"></A>MDAC Technical Articles</H1>

<P class=label><B>Corrections to "Mapping ADO Methods to OLE DB Interfaces"</B></P>

<P>In the article's section "ADO Objects to OLE DB Methods," ADO objects are listed with the OLE DB interfaces and methods that are called. The list of events for the <B>Recordset</B> object incorrectly states that no OLE DB interface is called. While it is true that ADO does not call OLE DB interfaces to support <B>Recordset</B> events, it does implement the <B>IRowsetNotify</B> callback interface to support those events. </P>

<P>In the article's section "ADO Collections to OLE DB Methods," the <B>Refresh</B> method of the <B>Parameters</B> collection should list <B>IDBSchemaRowset</B>.</P>
<hr>
<H1>Copyright</H1>

<P>Information in this document, including URL and other Internet web site references, is subject to change without notice and is provided for informational purposes only. The entire risk of the use or results of the use of this document remains with the user, and Microsoft Corporation makes no warranties, either express or implied. The example companies, organizations, products, people and events depicted herein are fictitious.&nbsp; No association with any real company, organization, product, person or event is intended or should be inferred. Complying with all applicable copyright laws is the responsibility of the user. Without limiting the rights under copyright, no part of this document may be reproduced, stored in or introduced into a retrieval system, or transmitted in any form or by any means (electronic, mechanical, photocopying, recording, or otherwise), or for any purpose, without the express written permission of Microsoft Corporation. </P>

<P>Microsoft may have patents, patent applications, trademarks, copyrights, or other intellectual property rights covering subject matter in this document. Except as expressly provided in any written license agreement from Microsoft, the furnishing of this document does not give you any license to these patents, trademarks, copyrights, or other intellectual property.</P>

<P>&copy; 1991-1999 Microsoft Corporation. All rights reserved.</P>

<P>Microsoft, MS-DOS, Windows, Windows NT, ActiveX, Visual Studio, Visual C++, Visual FoxPro, and MSDN are either registered trademarks or trademarks of Microsoft Corporation in the U.S.A. and/or other countries.</P>

<P>The names of actual companies and products mentioned herein may be the trademarks of their respective owners.</P>

<P><A HREF="#mdac_toc">Return to Contents</A></P>

</BODY>
</HTML>
